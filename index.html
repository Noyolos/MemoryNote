<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Afterglow</title>
    <link rel="stylesheet" href="/src/style.css">
</head>
<body>
    <div id="af-center-stage" class="af-center-stage">
        <div class="af-center-stage__top">
            <div id="af-agent-pill" class="af-agent-pill" role="button" aria-label="Agent selector">
                <span class="af-agent-dot" aria-hidden="true"></span>
                <span class="af-agent-name">Gemini</span>
            </div>
            <div id="af-typing-indicator" class="af-typing" hidden>对方正在输入…</div>
        </div>
        <div id="af-stage-stack" class="af-stage-stack">
            <div id="af-home-prompt" class="af-bubble af-bubble--ai" hidden>Use WORKSTATION -> UPLOAD to begin</div>
            <div id="af-user-bubble" class="af-bubble af-bubble--user" hidden></div>
        </div>
    </div>
    <div id="af-ai-boundary" aria-hidden="true">
        <div class="af-ai-boundary-line left"></div>
        <div class="af-ai-boundary-line right"></div>
    </div>
    <div id="af-ai-debug" class="af-ai-debug">
        <div class="af-ai-debug__title">AI BUBBLE</div>
        <label class="af-ai-debug__row">
            <span class="af-ai-debug__label">Width</span>
            <input type="range" id="af-ai-width" min="360" max="1400" step="10" value="560">
            <span id="af-ai-width-val" class="af-ai-debug__value">560px</span>
        </label>
        <label class="af-ai-debug__row">
            <span class="af-ai-debug__label">Font</span>
            <input type="range" id="af-ai-font" min="12" max="28" step="1" value="28">
            <span id="af-ai-font-val" class="af-ai-debug__value">28px</span>
        </label>
    </div>
    <div id="af-app-shell">
    <div class="af-nav">
        <div class="af-nav__brand">AFTERGLOW</div>
        <div class="af-nav__center">
            <div class="af-nav__link">THE GARDEN</div>
            <div class="af-nav__link">MEMORY</div>
            <div class="af-nav__link">MUSIC</div>
            <div class="af-nav__link" data-action="open-info">INFO</div>
        </div>
        <div class="af-nav__right">
            <div class="af-mode-toggle" id="af-render-toggle">
                <span class="af-mode-toggle__label">TEST</span>
                <div class="af-mode-toggle__seg">
                    <button class="af-mode-toggle__btn" id="af-render-kolam" type="button">Kolam</button>
                    <button class="af-mode-toggle__btn" id="af-render-halo" type="button">Halo</button>
                    <button class="af-mode-toggle__btn" id="af-render-layered" type="button">Layered</button>
                </div>
            </div>
            <button class="af-nav__reset hidden" id="af-hall-reset" type="button">Reset</button>
            <svg class="af-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M4 9v6M8 5v14M12 3v18M16 8v8M20 6v12"/>
            </svg>
            <svg class="af-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="3" y1="6" x2="21" y2="6"/>
                <line x1="3" y1="12" x2="21" y2="12"/>
                <line x1="3" y1="18" x2="21" y2="18"/>
            </svg>
        </div>
    </div>

    <div id="loading">PROCESSING...</div>

    <div id="ui-layer">
        <div id="settings-toggle" title="Toggle Controls">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
            </svg>
        </div>

        <div id="effect-panel">
            <div class="section-title">COLOR & LIGHT</div>
            <div class="control-group">
                <div class="control-label">Brightness <span class="control-value" id="val-brightness">1.70</span></div>
                <input type="range" id="inp-brightness" min="0" max="3" step="0.1" value="1.7">
            </div>
            <div class="control-group">
                <div class="control-label">Contrast <span class="control-value" id="val-contrast">1.30</span></div>
                <input type="range" id="inp-contrast" min="0" max="3" step="0.1" value="1.3">
            </div>
            
            <div class="section-title">PARTICLES</div>
            <div class="control-group">
                <div class="control-label">Particle Size <span class="control-value" id="val-particleSize">11.50</span></div>
                <input type="range" id="inp-particleSize" min="1" max="15" step="0.5" value="11.5">
            </div>
            <div class="control-group">
                <div class="control-label">Grid Opacity <span class="control-value" id="val-gridOpacity">0.50</span></div>
                <input type="range" id="inp-gridOpacity" min="0" max="1" step="0.1" value="0.5">
            </div>
            
            <div class="section-title">EROSION & PHYSICS</div>
            <div class="control-group">
                <div class="control-label">Erosion Speed <span class="control-value" id="val-erosionSpeed">0.15</span></div>
                <input type="range" id="inp-erosionSpeed" min="0" max="1" step="0.05" value="0.15">
            </div>
            <div class="control-group">
                <div class="control-label">Wave Amp <span class="control-value" id="val-waveAmplitude">0.17</span></div>
                <input type="range" id="inp-waveAmplitude" min="0" max="0.5" step="0.01" value="0.17">
            </div>
            <div class="control-group">
                <div class="control-label">Wave Speed <span class="control-value" id="val-waveSpeed">0.25</span></div>
                <input type="range" id="inp-waveSpeed" min="0" max="1" step="0.05" value="0.25">
            </div>
            <div class="control-group">
                <div class="control-label">Dispersion <span class="control-value" id="val-dispersion">0.10</span></div>
                <input type="range" id="inp-dispersion" min="0" max="3" step="0.1" value="0.1">
            </div>
            <div class="control-group">
                <div class="control-label">Roughness <span class="control-value" id="val-edgeRoughness">0.50</span></div>
                <input type="range" id="inp-edgeRoughness" min="0" max="3" step="0.1" value="0.5">
            </div>
            <div class="control-group">
                <div class="control-label">Safe Area <span class="control-value" id="val-stableRadius">0.44</span></div>
                <input type="range" id="inp-stableRadius" min="0.1" max="0.5" step="0.01" value="0.44">
            </div>

            <div class="section-title">HOME (TEMP)</div>
            <div class="control-group">
                <div class="control-label">Home Zoom <span class="control-value" id="val-home-zoom">2.80</span></div>
                <input type="range" id="af-home-zoom" min="0.8" max="6.0" step="0.1" value="2.8">
            </div>
            <div class="control-group">
                <div class="control-label">Home Y Offset <span class="control-value" id="val-home-y">0.05</span></div>
                <input type="range" id="af-home-y" min="-1.0" max="1.0" step="0.05" value="0.05">
            </div></div>

        <div id="control-panel">
            <div style="font-size: 10px; color: #888; letter-spacing: 2px; text-transform: uppercase; margin-bottom: 5px;">AFTERGLOW WORKSTATION</div>
            <div class="action-row">
                <div class="btn upload-btn-wrapper">
                    <span>Upload</span>
                    <input type="file" id="fileInput" accept="image/*" />
                </div>
                <button id="archiveBtn" class="btn">Archive</button>
            </div>
            <button id="enter-hall-btn" class="btn" style="border-color: #666; color: #fff; margin-top: 5px;">
                Enter Hall <span id="memory-count" style="opacity:0.6; font-size:9px; margin-left:5px;">(0)</span>
            </button>
        </div>

        <div id="gallery-ui" class="hidden">
            <button id="back-btn" class="btn" style="position:absolute; top:calc(var(--af-nav-offset, 56px) + 10px); left:30px; width:auto; padding:10px 25px; z-index:200;">&larr; Workstation</button>
            <div class="nav-zone left" id="prev-zone"><div class="arrow">&larr;</div></div>
            <div class="nav-zone right" id="next-zone"><div class="arrow">&rarr;</div></div>
            <div id="gallery-info">
                <div id="gallery-counter">MEMORY 01</div>
                <div style="font-size: 10px; opacity: 0.6; letter-spacing: 2px;">AFTERGLOW ARCHIVE</div>
            </div>
        </div>

        <div id="af-hud">
            <div id="af-home-voice" class="af-home-voice">
                <button id="af-mic-btn" class="af-mic" type="button" aria-label="Mic">
                    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                        <path d="M12 15a3 3 0 0 0 3-3V6a3 3 0 1 0-6 0v6a3 3 0 0 0 3 3Z"/>
                        <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                        <line x1="12" y1="19" x2="12" y2="22"/>
                        <line x1="8" y1="22" x2="16" y2="22"/>
                    </svg>
                </button>
                <div class="af-bottom-row">
                    <div id="af-voice-timer" class="af-pill-mini">00:00</div>
                    <button id="af-save-memory" class="af-save" type="button">
                        <span class="af-save-label">Save Memory</span><span aria-hidden="true">&gt;</span>
                    </button>
                    <button id="af-close-voice" class="af-close-x" type="button" aria-label="Close"></button>
                </div>
            </div>
        </div>

        <div id="af-info-panel" class="af-info-panel af-hidden" aria-hidden="true">
            <div class="af-info-card">
                <div class="af-info-head">
                    <div class="af-info-title">INFO</div>
                    <button id="af-info-close" class="af-info-close" type="button" aria-label="Close">×</button>
                </div>

                <div class="af-info-body">
                    <div class="af-info-kicker" id="af-info-memno">MEM 01</div>

                    <div id="af-info-empty" class="af-info-empty">
                        No diary for this memory yet.
                    </div>

                    <div id="af-info-diary" class="af-info-diary">
                        <div class="af-diary-title" id="af-diary-title"></div>
                        <div class="af-diary-meta">
                            <span id="af-diary-date"></span>
                            <span id="af-diary-mood"></span>
                        </div>
                        <div class="af-diary-tags" id="af-diary-tags"></div>
                        <div class="af-diary-summary" id="af-diary-summary"></div>

                        <details class="af-diary-details">
                            <summary>Transcript</summary>
                            <pre id="af-diary-transcript"></pre>
                        </details>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="canvas-container"></div>
    </div>

    <div id="af-landing" class="af-landing" aria-hidden="true">
        <div class="af-landing-card">
            <div class="af-landing-title">Afterglow Ritual</div>
            <div class="af-landing-copy">Upload an image to unlock your memory palace.</div>
            <button id="af-landing-upload" type="button">Upload Image</button>
        </div>
    </div>

        <div id="af-save-blocker" class="af-save-blocker" aria-hidden="true">   
            <div class="af-save-card">
                <span class="af-spinner" aria-hidden="true"></span>
                <span id="af-blocker-text">Generating diary...</span>
            </div>
        </div>

    <div id="af-diary-modal" aria-hidden="true">
        <div class="af-blob af-blob-1"></div>
        <div class="af-blob af-blob-2"></div>

        <div class="af-glass-card">
            <div class="af-card-content">
                <div class="af-card-header">
                    <div class="af-card-date-group">
                        <span id="af-modal-date" class="af-card-date">DEC 24</span>
                        <span id="af-modal-time" class="af-card-time">02:41 AM</span>
                    </div>
                    <div id="af-modal-mood" class="af-card-mood">NEUTRAL</div>
                </div>

                <div>
                    <h2 id="af-modal-title" class="af-card-title">Untitled Memory</h2>
                    <span id="af-modal-subtitle" class="af-card-subtitle">Captured in the Afterglow</span>
                </div>

                <div class="af-card-body">
                    <div class="af-card-line"></div>
                    <div id="af-modal-content" class="af-card-text">
                        (Content loading...)
                    </div>
                </div>

                <div class="af-ai-box">
                    <div class="af-ai-badge">
                        <svg width="8" height="8" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/></svg>
                        <span>AI Insight</span>
                    </div>
                    <p id="af-modal-ai-text" class="af-ai-text">Analyzing...</p>
                    <div id="af-modal-tags" class="af-ai-tags"></div>
                </div>

                <div class="af-card-footer">
                    <button id="af-modal-close" class="af-btn-close" type="button" aria-label="Close">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                    <button id="af-modal-share" class="af-btn-share" type="button">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></svg>
                        <span>Share</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="/src/main.js"></script>
</body>
</html>





